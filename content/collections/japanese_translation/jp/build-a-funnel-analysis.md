---
id: 0216ced2-cc05-4499-93d6-90df668d84eb
blueprint: japanese_translation
title: ファネル分析を構築する
title_en: 'Build a funnel analysis'
source: 'https://help.amplitude.com/hc/ja/articles/360052745632'
---
#### この記事のテーマ：

* ファネル分析チャートを構築する

Amplitudeの**ファネル分析**チャートは、プロダクト内でユーザーが定義されたパス（「ファネル」）をどのようにナビゲートするかを理解し、ユーザーがドロップオフする傾向がある問題領域を特定します。

ファネルの一般的な例は、正常にオンボーディングすることです。指定したオーダーで指定したイベントを発行する場合、Amplitudeは、ファネルを通じてユーザーがコンバージョンするとみなします。

この記事では、Amplitudeでファネル分析を構築するに必要なステップについて概説します。

## 開始する前に

[Amplitudeのファネル分析チャートの概要](/docs/analytics/charts/build-charts-add-events)するかについての基本もよく理解してください。

ファネル分析チャートを構築した場合は、[ファネル分析チャートを解釈する](/docs/analytics/charts/funnel-analysis/funnel-analysis-interpret)に進むことができます。

## ファネル分析を設定する

ファネル分析は、プロダクト内の特定のイベントシーケンスをユーザーがどのようにナビゲートするかを示します。ファネル分析チャートは、イベントモジュールとセグメンテーションモジュールを使用して構築されます。 ファネル分析チャートを作成するには、それらのイベントが何であるか、分析にどのユーザーを含めるかをAmplitudeに伝える必要があります。

**注意:**アクティブイベントと非アクティブイベントをファネル分析に含めることができますが、ほとんどのお客様は、Amplitudeチャートがアクティブイベントに焦点を当てる場合に、洞察力が高いと判断しています。

ファネル分析チャートを構築するには、次のステップに従ってください:

1. イベントモジュールで、**開始イベント**を選択します。 Amplitudeで実装されている特定のイベントを選択するか、または選択可能なイベントのリストから*Any Event（任意のイベント）*を選択して、この分析の開始イベントとして任意のイベントを検討するようAmplitudeに伝えることができます。
2. 必要に応じて+ Filter byをクリックして、プロパティ名を選択し、関心のあるプロパティ値を指定して、開始イベントにプロパティを追加します。
3. 次に、少なくとも**他のイベント**を選択してください。 これらのイベントにプロパティを追加することもできます。
4. ユーザーがコンバージョンとしてカウントするためにこれらのイベントをトリガーする必要がある**順序**を指定します。つまり[この順序、任意の順序、または正確な順序です](#h_6b432e9f-a491-439e-a2c6-005bc16bc6f6)。  
  
![build_funnel.gif](/docs/output/img/jp/build-funnel-gif.gif)

5. ファネルのステップ間で特定のイベントをトリガーするファネルからユーザーを**除外**するには、*+* *Exclude users*をクリックして実行したユーザーを除外し、ドロップダウンリストから排除イベントを選択します。 ファネル内のすべてのステップ間または2つの特定のステップ間で排除を適用できます。任意の順序ファネルでは、ファネルステップ間で排除イベントを発行した場合に、ユーザーは除外されます。

![excluded_who_did.png](/docs/output/img/jp/excluded-who-did-png.png)  
  
**注：**合計で測定する場合は、ユーザーを除外しても機能しません。

6. セグメンテーションモジュールで、分析に含めるユーザーセグメントを指定します。 保存済をクリックして、リストから必要なセグメントを選択することで、保存済みのセグメントをインポートできます。 そうでない場合、Amplitudeはすべてのユーザーを分析対象とするという前提からスタートします。  
  
**注意:**選択したユーザーセグメントは開始イベントにのみ適用されます  
  
。
7. 保存済みのユーザーセグメントをインポートしない場合は、プロパティを追加して新しいユーザーセグメントを作成できます。ユーザーセグメントを作成するには、 *+ Filter by*をクリックし、含めたいプロパティを選択して、関心のあるプロパティ値を指定します。
8. 既に何らかのアクションを実行したユーザーのみを含めるようにAmplitudeに指示することで、さらに属性を絞り込むこともできます。これを行うには、*+ Performed*をクリックし、関心のあるイベントを選択します。
9. 希望に応じて、*+ AAdd Segment*tをクリックし、ステップ6と7を繰り返して別のユーザーセグメントを追加します。

![segment.gif](/docs/output/img/jp/segment-gif.gif)  
  
**注**：希望に応じて、イベントモジュール内の*… + Group by*をクリックすることでユーザープロパティごとに開始イベントを細分化できます。 例えば、開始イベントを発行したときにユーザーがいた都市でグループ分けする場合、プロパティのリストから*City*を選択します。 その後、Amplitudeは都市ごとにリテンション分析を細分化します。ただし、分析に加味できるユーザーセグメントは1つだけです。

新しいファネル分析は、チャートモジュールに表示されるはずです。 次のセクションでは、高度な分析オプションを使用してデータを深く掘り下げる方法を説明します。

## 1回のステップで複数のイベントを比較する

1回のコンバージョンステップで最大3つのイベントを比較できます。 ファネルを構築するステップ4の後、Options フライアウトメニューからファネルを構築するステップ4の後、Compare Events at Step numberを 選択します。

![multiple_CEsin_funnel.png](/docs/output/img/jp/multiple-cesin-funnel-png.png)

ワンステップで複数のイベントを比較すると、コンバージョンと時間指標のコンバージョンが利用できます。 3つのイベントを、一度に最大2つのステップで、ステップごとに比較できます。 イベント比較は、3つの注文オプション（任意の注文、この注文、正確な注文）すべてで利用できます。ただし、ダッシュボードフィルタでは使用できません。ユーザーがチャートまたはファネル指標を切り替えると、削除されます。 

## ステップをオプションとしてマークする

ステップのいくつかがオプションであるコンバージョンを時々は定義する必要があります。 たとえば、ファネルには、ステップA、B、C、Dがあり、Bはオプションです。 ユーザーがステップA、C、Dを実行しても、コンバージョンします。

イベントサイドコントロールで *Optional step*をクリックして、ステップをオプションにします。 

![optional_step.png](/docs/output/img/jp/optional-step-png.png)

イベントがオプションとマークされている場合、サイドコントロールは*\*Optional*と言い、その周りに点線を持っています。 

![optional_side_control.png](/docs/output/img/jp/optional-side-control-png.png)

チャートは、2つのファネルを表示します。1つはステップ付きで、もう1つはステップなしです。コンバージョンテイクアウトと内訳表には、これら2つのシナリオも反映されます。

ステップをオプションとしてマークするには、複数の制限があります。

* コンバージョンと経時コンバージョンにのみ利用できます。
* 一度に1つのステップだけオプションにできます。
* 中間ステップのみをオプションにできます。 最初と最後のステップは、オプションにすることはできません。
* オプションイベントは、並べ替えできません。
* グループバイのイベントは、オプションにすることはできません。
* 複数のイベントを比較するイベントは、オプションにすることはできません。

インラインカスタムイベントは、ベータユーザーのファネルチャートとイベントセグメンテーションチャートで作成することもできます。 [詳細については、こちらの記事をお読みください](/docs/analytics/charts/event-segmentation/event-segmentation-in-line-events)。

## グループバイの値を互いに比較する

ファネルチャートでは、グループ化プロパティを別のベースラインプロパティと比較することもできます。ファネルチャートにセグメントプロパティグループバイが作成されると、*比較*ドロップダウンをクリックして、比較する値を選択します。

![compare_groupby.png](/docs/output/img/jp/compare-groupby-png.png)

その値を選択すると、ビジュアル値と内訳表にマウスポインタを合わせると、コンバージョン率の差がマイクロスコープで表示されます。 内訳表の特定のステップに関しては、絶対パーセント差とコンバージョンパーセント差の両方が表示されます。  
  
セグメントプロパティグループ化比較には、複数の制限があります：

* これらは、コンバージョンと経時コンバージョンにのみ利用できます。
* [プロパティ値と比較する]、あるいは[過去と比較する]のみに適用されます。
* 最大2つのセグメントグループバイに制限されます。

## イベントインラインを結合する

恒久的なカスタムイベントを作成して保存することなく、チャートコントロールでイベントの組み合わせを直接探索できます。 次のステップに従って、インライン比較用のカスタムイベントを追加します。

1. イベントサイドコントロールでクリックし、*イベントインラインを結合*![](/docs/output/img/jp/MRXBP5ODtzqgEnLlw4KApeJtYs3yI4j_xqEglHuDTfone2Kke4CmuakZCtOC5zQ50CVxeA1qtZrrTR09CzLlukIBIM6_urw6YsnX-AmYIPEJKBh3vaK0K8Rz1IHLfHYPbiUe3DZfnHnKN_xBqbVcUTA)を選択します。

![inline.png](/docs/output/img/jp/inline-png.png)

2. 次に *イベントインラインを追加*をクリックして、カスタムイベントを追加します。 必要なカスタムイベントの数を追加します。

![add_event_inline.png](/docs/output/img/jp/add-event-inline-png.png)

**注**：作成するインラインイベントは、特定のチャートにのみ関連し、他の場所ではアクセスできません。 

3. 必要に応じて、イベントにカーソルを合わせ、クリックして![](/docs/output/img/jp/ZwbrE-aEYlNqwYXo3JmP5_-5DxQL7U75usTphRdU88ISaZs3XpcGiillwYwDsVL8sk8LJgtVKgOSgs64thjZ2WAz4ApvW-ozbU18UsWNgUOxq7grcGo3lfQF29dOdXoA3My37_Q0cDZ8ljqN_VKKZ4M)イベントプロパティを追加します。各インラインイベントに必要な数のフィルタプロパティを追加します。

![filter_props.png](/docs/output/img/jp/filter-props-png.png)

4. 必要に応じて、![](/docs/output/img/jp/Y9JDZisQFX0iReFXznMOtqJUVcppUd7l5RxXZKvH2Bshtt4XYcAHArPKENBiWRR4rcMYsTArdZjZf-3qqAEtBz6_9r0UcJBAc2743WYljDtWt3iimrD-lBzl5W4QjmrtDMVqoRF7FGmzXMOFvyXvn10) をクリックし、プロパティとインラインイベントを削除します。

カスタムイベントには、他のカスタムイベントを含めることはできません。 また、*ユーザージャーニー*を表示、*コンバジョンドライバーの検索*、および*ユーザーパスを表示*は、ファネルのインラインイベントステップでは、マイクロスコープでは使用できません。

## Amplitudeはどのようにファネルを計算するか

他のチャートとは異なり、ファネル分析は、イベントモジュールに含めるイベントの**順序**を指定する必要があります。オプションは次のとおりです:

* **任意の順序**;
* **この順序**;または
* **正確な順序**。

*任意の順序*は正確に言えば:ユーザーがリストした**すべてのステップを完了する**限り、Amplitudeはコンバージョンしたとみなします。最初のイベントを発行することなく、後のイベントを発行するユーザーは、ファネルの一部とみなされます;そうなるには、最初のイベントを発行する必要があります。

*この順序は*、Amplitudeはコンバージョンと考える前に**、指定した順序で**選択したイベントを発行する必要があります。ただし、ユーザーは、関心のあるイベント間で**他のイベントを発行する場合もあります**。その場合でも、Amplitudeはコンバージョン間で

**注意:***この順序*を使用する場合、ファネルでイベントを繰り返すことができます。ファネルをイベントA ->イベントA ->イベントBとして定義している場合で、ユーザーがイベントAを少なくとも2回発行した場合は、コンバージョンとしてカウントされます。ファネル定義にイベントが表示される回数に制限はありません。

*正確な順序*は*、この順序*の厳格なバージョンです。そこでは、ユーザーは、リストされているイベント間で他のイベントを発行する場合、コンバージョンとして**カウントされません**。ユーザーがイベントモジュールにリストされているステップから逸脱する場合、Amplitudeはドロップオフしたとみなします。

**注：**順序付きファネルでは、各イベントは、ちょうど1つのコンバージョンパスに含まれます。 たとえば、2つのイベントで順序付けられたファネルがある場合、`検索→カートに追加します`。 ユーザーが4回検索し、最後の検索の後に製品をカートに追加（`検索、検索、検索、カートに追加）`する場合、ファネルの最初のステップが4回発生した場合でも、Amplitudeは**1**回のコンバージョンを記録します。

## Amplitudeが同時イベントをどのように処理するか

Amplitudeは、すべての時間を最も近い秒に切り上げます。そのため、**同時イベント**のためのアカウントに1秒ウィンドウを維持します。ユーザーが1秒以内に2つの異なるイベントを発行する場合、Amplitudeはどちらが最初に来るかを判断しません。代わりに、**どちらの**順序が正しいかを考慮し、ファネルに適用します。

例えば、ユーザーがイベントBを最初に**発行**し、イベントAを1秒以内に発行する場合、ファネルはイベントA ->イベントB、**または**イベントB ->イベントAからのコンバージョンとしてカウントします。

同じイベントタイプの2つが同じ秒内に送信される場合、Amplitudeはそれらのイベントを1つのみとカウントします。

正確な順序ファネルで、ファネル定義の一部でないイベントが、同じ秒内に同時に発行される場合、Amplitudeはそのユーザーがコンバージョンしたとみなします。

**注意:***同じ*秒内に発生する*同じ*イベントに[Historical Count(履歴カウント)](/docs/analytics/historical-count-1)フィルターを使用している場合、ユーザーはドロップオフしたように見えます。これは、ファネルクエリが同じ秒内に起こるイベントを区別しないためですが、履歴カウントフィルターは区別します。

## Amplitudeがユーザープロパティでセグメントをどのように処理するか

[ユーザープロパティでデータをセグメント](/docs/analytics/charts/build-charts-add-events)すると、Amplitudeはファネルの最初のステップにセグメンテーションを適用します。

例えば、イベントAがファネルの最初のステップで、ユーザーは次のものを発行したとします:

* ユーザープロパティ`[Amplitude] Country` = C`anad`; and thenを有するEvent B
* ユーザープロパティ`[Amplitude] Country` = `United States`を有するEvent A

「... by Active country(s)で」セグメントする場合、Amplitudeは、Event Aステップの「`[Amplitude] Country`」=「`United States`」セグメントにこのユーザーを表示します。

次は、[ファネル分析を解釈](/docs/analytics/charts/funnel-analysis/funnel-analysis-interpret)します。
