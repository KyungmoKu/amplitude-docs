---
id: 1b85a1fc-8254-4c3a-be3f-d9ae8066ffac
blueprint: japanese_translation
title: トラブルシューティング：モバイル属性（インストール/アンインストール）イベント
title_en: 'Troubleshooting: Mobile Attributes (Install/Uninstall) Events'
source: 'https://help.amplitude.com/hc/ja/articles/360051234592'
---
モバイル属性パートナーは、IDFA/IDFV/ADIDの広告IDを使用してイベントを識別します。しかし、ご存知のようにAmplitudeは、user\_id、device\_id、amplitude\_idの組み合わせに基づいてユーザーを識別します。 したがって、モバイル属性パートナーとAmplitudeの間の識別子は異なるため、どうすればAmplitudeでイベントを正しいユーザーにマッピングできるのでしょうか？

そこで[属性API](https://developers.amplitude.com/docs/attribution-api)の登場です：これは、属性イベントをAmplitudeの既存のユーザーにマッピングする特別なエンドポイントで、ノントラディショナルなAmplitude識別子、別名広告IDをマッチングします。 ワークフローは、次のとおりです。 

1. Instrument Amplitudeは、最初に広告IDが有効になっているため、すでにデータを収集しています。
2. Appsflyer/Adjust/Branch/Singularなどのモバイル属性パートナーは、属性APIを使用して、カスタムではない標準のデータを識別子として広告IDで送信します。
3. Amplitudeは、マップされていない属性イベントを72時間保存します。
4. その72時間以内にAmplitudeは、Amplitudeプロジェクトにすでに存在しているユーザーのIDFA、IDFV、ADIDが一致するかどうかをチェックします。
5. すでに存在するユーザーに一致するIDFA、IDFV、ADIDがある場合、Amplitudeはその属性イベントをそのユーザーにルーティングします。
6. それらがない場合、かつ属性イベントが取り込まれてから72時間が経過した場合、属性イベントはドロップされます。

以下のフローチャートでは、マッピングが広告IDのマッチングを介して、Amplitudeイベントと属性イベントをどのように調整するかを示しています。

![Screenshot_2020-10-28_at_17.02.07.png](/docs/output/img/jp/screenshot-2020-10-28-at-17-02-07-png.png)

つまり、Amplitudeが属性イベント取り込むためには、次の2つの要件を満たす必要があるということです：

* 一致するIDFA、IDFV、ADIDを持つAmplitudeの既存のユーザーであること
* マッピングが72時間以内に完了していること

### モバイル属性イベントがない理由（可能性があるもの）

前のセクションでは、属性イベントがAmplitudeに表示されない最も一般的な理由は、次のとおりです：

1. 一致するIDFA、IDFV、ADIDを持つAmplitudeの既存のユーザーではない
2. マッピングが72時間以内に作成されなかった

次のセクションで、これらの一般的な理由をトラブルシューティングする方法について説明します。 しかし、その前に、次のようなAmplitudeで属性イベントが表示されない可能性がある、その他の潜在的な理由がいくつか挙げておきます：

1. 属性イベントがAmplitudeに正常に送信されなかった。イベントを送信する際に、属性パートナーが200の成功応答を受け取っていることを確認してください。
2. プロジェクトが[計測制限](https://help.amplitude.com/hc/en-us/articles/115002923888-Limits#h_8d90ca72-bf91-4161-88b2-01b5448b0859)に達した。新しいイベントタイプとプロパティを取り込むために、イベントタイプまたはプロパティを削除する必要がある場合があります。
3. そのイベントタイプがAmplitudeプロジェクトでブロックまたは削除されていました。データを介してイベントタイプまたはプロパティを復元してください。

200件の応答が受信され、制限に達しておらず、イベント/プロパティがブロックまたは削除されていない場合は、次のセクションに移動してください。 

### トラブルシューティング：一致するIDFA、IDFV、ADIDを持つAmplitudeの既存のユーザーではない

モバイル属性イベントがAmplitudeに取り込まれない最大の理由の１つは、Amplitudeに一致フィールドを持つ既存のユーザーがいないことです。**これは、モバイル属性イベントを送信する前に、Amplitudeを計測する必要があることを意味します。** 

#### 広告IDを追跡しているかどうかを判断する方法

広告IDは、IDFA、IDFV、ADIDです。 Amplitudeイベントで広告IDをトラッキングしている場合、Amplitudeはそれぞれのプロパティフィールドの値をキャプチャします。 ただし、セキュリティとPIIの理由から、IDFA、IDFV、ADIDは使用可能なプロパティとして表示されず、キャプチャされた後にRAWデータから削除されます（カスタムプロパティとして計測されない限り）。 

Amplitudeは、「amplitude\_attribution\_ids」というフィールドの下に広告IDのハッシュバージョンを保存します。 このフィールドを使用して、広告IDを計測しているかどうかを識別できます。

「amplitude\_attribution\_ids」が表示される場合：次の例で示すように、「null」が表示されている場合、これはこのユーザーの広告IDがキャプチャされなかったことを意味します。

#### Screen_Shot_2022-12-29_at_4.46.20_PM.png

これは、2つのことを意味する可能性があります： 

1. 1. 計測が広告IDをキャプチャしていない。
	2. エンドユーザーが広告IDトラッキングをオプトアウトしていた。

ユーザーオプトアウトは、尊重する必要があります。 エンドユーザーにオプトアウトしないように依頼する以外に、ここで行えることは何もありません。広告IDが適切に追跡されていることがわかっていて、ユーザーオプトアウトのために「amplitude\_attribution\_ids」が「null」であることを確認したい場合は、サポートに連絡してください。

#### ソリューション：広告IDのトラッキング

計測が広告IDをキャプチャしない問題を解決するには、[広告IDのトラッキング](https://developers.amplitude.com/docs/ios#advertising-id)ドキュメントで説明されているように、広告IDトラッキングが有効になっていることを確認してください。

JavascriptまたはReact Native SDkを使用している場合、広告IDを自動的に追跡する可能性がない場合は、[HTTP API](/docs/data/sources/instrument-track-unique-users)できます）。

### トラブルシューティング：マッピングが72時間以内に作成されなかった

Amplitudeは、属性イベントを72時間保持します。 72時間以内に一致が見つからなかった場合、その属性イベントは削除されます。

これは特に、ユーザーが4日後までアプリを使用しない場合に可能です。 例えば、ユーザーAは12月1日にゲームアプリをダウンロードしますが、12月7日までアプリを開かない場合などです。 

* モバイル属性パートナーは、12月1日にユーザーAのインストールイベントをリストし、そのイベントを12月1日にAmplitudeに送信します。
* ユーザーAは、12月7日にアプリを開くまで、Amplitudeで最初のイベントを記録しません。ですから、ユーザーAは12月7日にAmplitudeで新しいユーザーと見なされます。

ユーザーAのインストールイベントは、ユーザーAが最初にAmplitudeに存在しなかったか、アトリビューションイベントの72時間以内に存在しなかったため、削除されます。ユーザーAは、72時間の保持期間よりも長い、インストールイベントの7日後にのみAmplitudeに存在したことになります。

#### 属性イベントの発生が早すぎるかどうかをチェックする方法

前述のように、モバイル属性パートナーは、Amplitudeと比較して大きく異なる識別子を持っています。さらに、AmplitudeでキャプチャされたIDFA、IDFV、ADID値は、UIで表示されません。 それでは、属性イベントの発生が早すぎるかどうかをチェックする方法ではどうでしょうか？

幸いなことに、AmplitudeのiOS SDKは、デフォルトでIDFVを「device\_id」としてキャプチャします。 iOS SDKのデフォルト設定を使用している場合は、iOSの例を使用して、これをトラブルシューティングできます。 

1. 「amplitude\_attribution\_ids」の値がある場合でも、インストールイベントを持たないiOS SDKユーザーを識別する
2. そのユーザーの「device\_id」、別名「IDFV」をコピーする
3. モバイル属性プロバイダで、IDFVのインストールイベントを探す
4. インストールイベントで日付をチェックする
5. その日付とAmplitudeで新しいユーザー日付を比較する

インストールイベントの日付により、ユーザーがAmplitudeに存在する72時間以上前に送信されていることがわかります。

あるいは、同様のプロセスに従うことで、ユーザーがAmplitudeにまだ存在していないかどうかを確認することもできます。

1. まだAmplitudeに表示されていないモバイル属性プロバイダから、iOSインストールイベントを識別する
2. そのペイロードでIDFVをつかむ
3. ユーザールックアップでIDFVを「device\_id」として入力する

IDFVは、Amplitudeのプロファイルと関連していないことがわかります。つまり、Amplitudeはまだユーザーを確認していないということです。 属性イベントがAmplitudeに送信されてから、マッチングが発生するまでまだ72時間あります。 72時間後にまだ既存のユーザーがない場合、属性イベントが削除されます。 

#### ソリューション：実際のユーザーアクティビティの前にユーザーを作成する

エンドユーザーは最初のイベントがAmplitudeに発行された時点で、Amplitudeに存在します。エンドユーザー自身のアクションによってプロファイル作成がトリガーされるのを待ちたくない場合は、エンドユーザーの代わりにプロファイルを作成できます。次のいずれかで行うことができます：

* HTTP APIを介して、広告IDと「device\_id/user\_id」でダミーイベントを送信する
* ID APIを介して、広告IDと「device\_id/user\_id」でプロファイルを作成する

これは、広告IDを自分でキャプチャし、正しい「device\_id/user\_id」を維持して、実際のユーザーアクティビティが適切なプロファイルに収まるようにできる場合にのみ可能です。
