---
id: 9704c291-c479-4b4f-9a21-238736e16967
blueprint: japanese_translation
title: Amplitudeでチャートをビルド：ユーザーセグメントを追加する
title_en: 'Building Charts with Amplitude: Adding User Segments'
source: 'https://help.amplitude.com/hc/ja/articles/13650690245915'
---
"#### この記事のテーマ：

* チャートにユーザーセグメントを追加する
* ユーザープロパティがあなたの分析をどのように形成するかを理解する
* 条件を使用して、分析を微調整する

**注意：**まだ行っていない場合は、このまま続ける前に[Amplitudeチャートにイベントを追加すること](/docs/analytics/charts/build-charts-add-events)に関するヘルプセンターの記事をお読みでください。

イベントは、そのものが重要ですが、数式の半分に過ぎません。また、分析したいユーザーの行動を指定する必要があります。

Amplitudeの**セグメンテーションモジュールは**、分析するユーザーのグループを作成できます。これらのグループはセグメントと呼ばれ、ユーザーベース全体と同じくらい幅広いか、ユーザープロパティの高スペックに合うよう、非常に狭くカスタマイズされています。

**注意:**それらはさまざまな種類の分析のために設計されているため、Amplitudeの[ペルソナ](/docs/analytics/charts/compass/compass-aha-moment)チャートにはセグメンテーションモジュールがありません。これらのチャートを使用して分析を構築する方法についての詳細は、上のリンクをクリックしてドキュメントを参照してください。  
  
また、[セグメンテーションモジュールで利用可能な高度な機能](/docs/analytics/charts/build-charts-segmentation-module)に関するヘルプセンターの記事を参照してください。

### ユーザーセグメントを作成する

最初のステップは、セグメントからどのカテゴリから抽出するかを決定することです。**すべてのユーザー**、**アクティブユーザー**、または**新規ユーザー**。

![build_charts_in_amplitude_segment_by_1.png](/docs/output/img/jp/build-charts-in-amplitude-segment-by-1-png.png)

仮に任意のユーザーを選択すると、分析には関心のあるイベントをトリガーしたすべてのユーザーが含まれます。これは、可能な限り広い選択です。

*アクティブユーザー*を選択して、焦点を少し絞り込むことができます。Amplitudeのアクティブユーザーの定義は、指定された時間中に**少なくとも1つのイベントを記録**したユーザーです。このオプションを選択すると、Amplitudeは、分析の対象となる日、週、または月にアクティブだったユーザーによってトリガーされたイベントを表示します。

さらに詳しくするには、*新規ユーザー*オプションがあります。新規ユーザーは、Amplitudeでイベントを初めてログインするユーザーとして定義されます。この選択を選択すると、Amplitudeは、ユーザーが新規だった**間隔**（日、週、または月）の間にこれらのユーザーがトリガーしたイベントを表示します。

例えば：ユーザーが、7月17日に分析インターバルを新規で*毎日*にトリガーする場合、**同じ日に**トリガーされたイベントのみがチャートに表示されます。ただし、ユーザーがイベントを翌日にもトリガーさせたかどうかとは関係ありません。

最後に、[アカウント](/docs/analytics/account-level-reporting)アドオンがある場合は、*ユーザー*の代わりに計装したカスタムグループのいずれかを選ぶこともできます。

![build_charts_in_amplitude_select_by_custom_group.png](/docs/output/img/jp/build-charts-in-amplitude-select-by-custom-group-png.png)

ユーザーを測定する方法を決定したら、*フィルター* と*実行済み*を使用して、ユーザーセグメントを定義します。 

**重要な注意事項**

* セグメント定義は、**各イベント時の**  
ユーザープロパティ値を参照します。例えば、`City = Amsterdam`のイベントを実行し、直近に`Country = United Kingdom`のイベントを実行したユーザーがあり、チャートに*where City = Amsterdam*のセグメントを追加する場合、`City = Amsterdam`のときにユーザーが実行したイベントのみがチャートに含まれます。ユーザープロパティに基づいてイベントでクエリする必要がある場合は、そのイベントをログする前に、ユーザープロパティが設定されていることを確認してください。詳細情報は[こちら](/docs/data/user-properties-and-events)をご覧ください。
* `デバイスID`、`イベントID`、`Latitude`、`Longitude`、`サーバーアップロード時間`、`セッションID`、`ユーザーID`または`ID`でセグメントする場合は、求めている正確な値を入力する必要があります。これは可能な値の濃度が高いためです。ユーザープロパティ`イベントID`、`緯度`、`経度`、`サーバーアップロード時間`または`ID`ではグループ化できません。

これで最初のユーザーセグメントが作成できました。

### セグメントを変更する

前のセクションで作成したセグメントは完璧に機能しています。分析の幅に応じて、必要なすべてを備えています。しかし、多くのAmplitudeユーザーは、もっと掘り下げて、特定のプロパティの組み合わせに基づいてユーザーセグメントを作成できます。セグメンテーションモジュールでは、高精度でユーザーセグメントを定義するのに必要なすべてのツールが表示されます。

ユーザーセグメントにフィルタを適用するには、次のステップに従ってください:

1. ユーザーセグメントの下で *+ [フィルター]* をクリックします。イベントの**下で** *+ [Filter by]* をクリックしないことを確認してください。
2. ユーザープロパティを選択から.*..をクリック*して、フィルターに追加するユーザー[プロパティ](/docs/analytics/behavioral-cohorts)ートを選択します。
3. 含めるユーザープロパティの値を選択します（または排除する値）。
4. 次に、フィルターでこのプロパティがどのように使用されるかを定義する次の演算子を選択します: is, is not, contains, does not contain, less/greater than (または equal to), set is, set is not, set contains, set does not contain, および glob match  
  
![build_charts_in_amplitude_segment_operator.png](/docs/output/img/jp/build-charts-in-amplitude-segment-operator-png.png)

**注意**：複数のプロパティ値を入力すると、オペレータはORステートメントとして機能します。ANDステートメントを作成するには、節*で*フィルターされた別の「where」を追加します。

* **「is」または「is not」: is** またはis *n*ot 演算子を使用して、セグメント定義に正確なプロパティ値を含めるか、または排除します。
* **「contains」または「contains not into」:conta**insまたは*d**oes not contain*演算子を使用して、セグメント定義に特定のサブストリングを持つプロパティ値を含めるか、または排除することができます。この演算子は大文字と小文字を区別しません。
* **「set is」または「set is not」: set is** または *set* *is* not演算子を使用して、特定の配列セットを含めるか、または排除できます。

* 例えば、「Movies」と「Music」の配列セットを持つユーザーを含むセグメントを、「Interests」 {=}(set is)「Movies, Music」と定義できます。これは、ユーザーの配列セットが「Movies」と「Music」を正確に含んでいる必要があることを意味します。したがって、ユーザーが「Movie」のみを持っている場合は、定義を満たすことがありません。同様に、ユーザーが「Movies」と「Music」に加えて「スポーツ」を持っている場合、**定義を満た**すことはありません。

* **「set contains」または「set does not contain」:**これらの演算子は、選択されたすべての値を含むリスト値と一致するか、またはすべての選択を含まないリスト値と一致します。これは、例えば、複数のA/Bテストグループに属するユーザーを確認するのに便利です。
	* * ユーザープロパティ配列から特定の値を排除する場合は、「set does not contain」を使用します。
		* 複数の値が選択されている場合、これらの演算子は値に「AND」ステートメントを適用します。例えば、条件がグループAとグループBを含まない（「set does not contain」）に設定されている場合、ユーザーは、排除されるグループAおよび(AND)グループBにいる必要はありません。「OR」ステートメントを適用する場合は、複数の「set does not contain」フィルターを適用する必要があります。

* **「glob match」または「glob does not match」:**Amplitudeには、規則表現のシンプルなバージョンがあり、「/org/\*/chart/\*」などの文字列を一致または排除させることができます。これはワイルドカードのようなものです。「\*[0-9]」または「[!」などの文字列を入力することもできます。a-z]\*"は、数字で終わるか、文字でないもので始まる値と一致します。globマッチングの詳細については[、こちら](https://en.wikipedia.org/wiki/Glob_(programming))を参照してください。
	* * アスタリスクは、「/」以外の文字のみと一致します。「/」を含む文字列を検索するには、2つのアスタリスクを使用します。たとえば、URLフォーマットが`www.example.com/blogs/blog_id`であり、「ブログ」という単語を含むすべてのURLをフィルターする場合、glob matchを使用して`**blogs**`と入力します。

詳細については、[Amplitudeで配列演算子がどのように機能するか](/docs/analytics/charts/array-operators)に関するヘルプセンターの記事を参照してください。

現在の名前をカーソルをかざしてクリックし、セグメントの名前を変更することもできます。注意:また、そうすることで、すでに使用しているチャートでセグメントの名前も変更されます。

#### OR節を使用する

同じプロパティの複数の値をフィルターするには、*[選択]値(s)...]*ボックスに追加するだけです。これにより、セグメントの定義にOR節が生成されます。下のスクリーンショットでは、米国またはカナダまたは英国または日本でイベントを発行したユーザーがセグメントに含まれます。

**注意:**これは、演算子を「set is」または「set is not」に設定した場合には、適用されません。

#### build_charts_in_amplitude_segment_or_operator.png

#### OR節を使用する

別のフィルターを追加すると、セグメント定義にAND節が生成されます。さらにフィルターを追加するには、[*+フィルター]*をクリックします。以下のスクリーンショットでは、セグメント定義には、米国でイベントを発行したユーザーおよび(AND)ドイツでイベントを発行したユーザーが含まれます。

![build_charts_in_amplitude_segment_and_operator.png](/docs/output/img/jp/build-charts-in-amplitude-segment-and-operator-png.png)

### さらにセグメントを追加する

Amplitudeは単一のセグメントに分析を制限しません。追加のセグメントを追加するには、*+ Add Segment*をクリックします。ここでは、比較する2つのセグメントがあります:米国のユーザーを含むものと、ブラジルのユーザーを含むものです。

![build_charts_in_amplitude_multiple_segments.png](/docs/output/img/jp/build-charts-in-amplitude-multiple-segments-png.png)

### ユーザープロパティでグループ化する

セグメンテーションモジュールには、機能*別のグループセグメント*も含まれます。

分析にイベントが1つしか存在しない場合は、イベントモジュールまたはセグメントモジュールでGroup Segment byを使用するかどうかは関係ありません。しかし、分析に**複数のイベントが含まれている場合**、セグメントモジュールにおいて条件毎の*グループセグメント*の追加を適用すると、それが分析のすべてのイベントに適用されます。そうしたくない場合は、イベント単位のイベントモジュールで*グループ化*条件を適用します。

**注意：**セグメントモジュールでグループ化を*使用*すると、分析が1つのユーザーセグメントに制限されます。さらにユーザーセグメントが必要な場合は、イベントモジュール内の各イベントに*group by*条件を適用します。

選択された測定によって、チャート上位5つのセグメントが表示されます。下のデータテーブル経由でチャートにセグメントを追加または削除できます。下記の例では、デバイスファミリーによる分析グループになっています。グラフは過去30日間の1日当たりアクティブユーザーの数を示します。これは使用したデバイスファミリーによってグループ化されています。

**注意:** この期間中にプロパティに複数の値がある場合、ユーザーは複数のセグメントに分類できます。  
さらに、複数の*gruop by*条件を追加することもできます。

### ユーザーセグメントを保存する

ユーザーセグメントを作成したら、別の分析で再使用するために保存できます。保存されたユーザーセグメントは他のチームメンバーがグローバルで利用できるものです。

ユーザーセグメントを保存するには、*[保存]*をクリックします。次に、セグメント保存をクリックして、次のウィンドウ内のプロンプトに従います。

保存*済*みのセグメントのドロップダウンから以前に保存したセグメントを検索することもできます。リストから必要なものを選択して、ロードします。

セグメントにデフォルトセグメントを作成するには、セグメントの名前の横にある「*デフォルトとして設定」*をクリックします。これは、つまり、新規のチャートを作成するときに、Amplitudeが自動的にロードするものということです。

![build_charts_in_amplitude_default_segment.png](/docs/output/img/jp/build-charts-in-amplitude-default-segment-png.png)

"