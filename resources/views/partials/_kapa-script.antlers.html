<script>
    function getPageInfo() {
        return {
            path: window.location.pathname,
            product: window.location.pathname.split('/')[1],
            url: window.location.href
        };
    }
    
    const initKapa = function () {
        var script = document.createElement("script");
        script.src = "https://widget.kapa.ai/kapa-widget.bundle.js";
        script.setAttribute("data-website-id", "ad8ecaa4-5c43-413b-9d0a-8114b6e1f831");
        script.setAttribute("data-project-name", "Amplitude");
        script.setAttribute("data-project-color", "#301661");
        script.setAttribute("data-project-logo", "https://avatars.githubusercontent.com/u/2291562?s=280&v=4");
        script.setAttribute("data-modal-example-questions","How do I install Amplitude on my website?,How do I install Amplitude in my mobile App?,How do I get started with Experiment in my application?")
        script.async = true;
        document.head.appendChild(script);
        // Tracking stuff starts here. 
        setTimeout(function () {
            const kapaWidget = document.getElementById("kapa-widget-container")
    
            kapaWidget.addEventListener("click", function () {
                amplitude.track('Kapa Click', getPageInfo())
                setTimeout(function () {
                    const kapaSearchButton = document.getElementsByClassName("mantine-UnstyledButton-root mantine-ActionIcon-root")
                    const kapaSearchBox = document.getElementsByClassName('mantine-Textarea-input')
                    kapaSearchButton[1].addEventListener("click", function () {
                        let kapaQuestion = kapaSearchBox[0].value
                        // Kapa Search event here
                        amplitude.track('Kapa Search', {
                            ...getPageInfo(),
                            question: kapaQuestion
                        })
                    })
                    kapaSearchBox[0].addEventListener("keydown", function (event) {
                        
                        if (event.key === 13 || event.key === 'Enter') {
                            let kapaQuestion = kapaSearchBox[0].value
                            amplitude.track('Kapa Search', {
                                ...getPageInfo(),
                                question: kapaQuestion
                            })
                        }
                    })
    
                }, 1000)
            })
        }, 1500);
        // });
    }
    
    initKapa()
    </script>